<div class="header">
  <h4 class="title">Статистика</h4>
  <p class="category">Список слушателей</p>
</div>
<div class="one" #one></div>
<div class="content">
    <ng-container *ngIf="currentUser.is_cathedra == null || currentUser.is_cathedra != 1">
      <preloader  *ngIf="isLoading"></preloader>
      <tabset>
        <tab heading="Текущие">
          <div class="content">
            <accordion>
              <accordion-group #group *ngFor="let faculty of faculties">
                <div accordion-heading>
                  {{ faculty.name }}
                  <span class="pull-right float-xs-right">Всего обучается: {{ faculty.Total - deducts }}</span>
                </div>
                <accordion>
                  <accordion-group *ngFor="let cathedra of faculty.CathedraList" #cathedraGroup [panelClass]="cathedra.CourseList.length != 0 ? 'panel-success' : 'panel-default'">
                    <div accordion-heading>
                      {{ cathedra.name }}
                      <span class="pull-right float-xs-right">Всего обучается: {{ cathedra.Total }}</span>
                    </div>
                    <div>
                        <table class="table table-striped table-hover table-responsive" *ngIf="cathedra.CourseList.length !== 0">
                            <thead>
                                <tr>
                                    <th>Номер</th>
                                    <th>Название курса</th>
                                    <th>Начало</th>
                                    <th>Конец</th>
                                    <th>Зачислено</th>
                                    <th>Свободно</th>
                                </tr>
                            </thead>
                            <tbody>
                              <ng-container *ngFor="let course of cathedra.CourseList">
                                <tr (click)="showListOfListners(course)" [ngClass]="{'active': course.isOpened}">
                                    <td>{{course.Number}}</td>
                                    <td>{{course.name}}</td>
                                    <td>{{course.Start | date: "dd.MM.yy"}}</td>
                                    <td>{{course.Finish | date: "dd.MM.yy"}}</td>
                                    <td class="success" align="center">{{course.StudList.length}}</td>
                                    <td class="warning" align="center">{{course.Size - course.StudList.length}}</td>
                                </tr>
                                <tr *ngIf="course.isOpened">
                                  <td colspan="6" class="no-padding">
                                    <table-list [course]="course" (onChanges)="onChanges($event)"></table-list>
                                  </td>   
                                </tr>
                              </ng-container>
                            </tbody>
                        </table>
                    </div>
                  </accordion-group>
                </accordion>   
              </accordion-group>
            </accordion>
          </div>
        </tab>
        <tab heading="Архив" (select)="getArchive()">
          <archive></archive>
        </tab>
      </tabset>
        <!-- <tab heading="Добавить курс">
          <div class="content">
            <div class="card">
              <div class="header">
                <h4>Данные нового курса</h4>
              </div>
              <div class="content row">
                <form (ngSubmit)="addForm.valid && SaveCourse()" #addForm="ngForm" novalidate>
                  <div class="col-lg-12 col-md-12">
                    <div class="form-group col-lg-2 col-md-2">
                      <label>Номер курса</label>
                      <input type="text" class="form-control" [(ngModel)]="newCourse.number" name="number" required>
                    </div>
                    <div class="form-group col-lg-7 col-md-7">
                      <label for="">Название</label>
                      <input type="text" class="form-control" name="name" [(ngModel)]="newCourse.name" required>
                    </div>
                    <div class="form-group col-lg-3 col-md-3">
                      <label for="">Тип</label>
                      <select name="type" [(ngModel)]="newCourse.type" class="form-control">
                        <option *ngFor="let opt of types" value="{{ opt.id }}" [attr.selected]="opt.id == 1 ? '' : null">{{ opt.value }}</option>
                      </select>
                    </div>
                    <div class="form-group col-lg-2 col-md-2">
                      <label for="">Начало</label>
                      <input #Start="ngModel" required type="text" [(ngModel)]="newCourse.start" [minDate]="global.minDate" [maxDate]="global.maxCourse" #StartDate="bsDatepicker" [bsConfig]="global.bsConfig"  bsDatepicker  name="start" class="date-picker form-control">
                    </div>
                    <div class="form-group col-lg-2 col-md-2">
                      <label for="">Конец</label>
                      <input #Start="ngModel" required type="text" [(ngModel)]="newCourse.finish" [minDate]="global.minDate" [maxDate]="global.maxCourse" #FinishDate="bsDatepicker"  [bsConfig]="global.bsConfig" bsDatepicker name="finish" class="date-picker form-control">
                    </div>
                    <div class="form-group col-lg-2 col-md-2">
                      <label for="">Набор</label>
                      <input type="number" class="form-control" name="size" [(ngModel)]="newCourse.size" required>
                    </div>
                    <div class="form-group col-lg-6 col-md-6">
                      <label for="">Целевая аудитория</label>
                      <input type="text" class="form-control" name="notes" placeholder="Например: для врачей-анестезиологов-реаниматологов, врачей-терапевтов, врачей-хирургов" [(ngModel)]="newCourse.notes" required>
                    </div>
                    <div class="form-group col-lg-12 col-md-12">
                      <button class="btn btn-danger" type="reset">Сбросить</button>
                      <input class="btn btn-success" type="submit" value="Сохранить">
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </tab> -->
      </ng-container>
    <ng-container *ngIf="currentUser.is_cathedra == 1" #courseLists>
      <tabset>
        <tab heading="Действующие">
          <preloader  *ngIf="isLoading"></preloader>
          <div class="content table-responsive table-full-width" *ngIf="currentCourses.length !== 0">
            <table class="table table-striped table-hover">
              <tr>
                <th>Номер</th>
                <th>Названи е</th>
                <th>Начало</th>
                <th>Коне ц</th>
                <th>Набор</th>
                <th>Зачислено</th>
                <th>Инфо</th>
              </tr>
              <ng-container *ngFor="let course of currentCourses">
                <tr (click)="showListOfListners(course)" [ngClass]="{'active': course.isOpened}">
                    <td>{{course.Number}}</td>
                    <td>{{course.name}}</td>
                    <td>{{course.Start | date: "dd.MM.yy"}}</td>
                    <td>{{course.Finish | date: "dd.MM.yy"}}</td>
                    <td>{{ course.Size }}</td>
                    <td>{{ course.StudList.length }}</td>
                    <td>{{ course.Notes }}</td>
                </tr>
                <tr *ngIf="course.isOpened">
                  <td colspan="7" class="no-padding">
                    <table-list [course]="course"></table-list>
                  </td>   
                </tr>
              </ng-container>
              <tr *ngIf="message.length != 0">
                <td>{{ message }}</td>
              </tr>
            </table>
          </div>
          <div class="content">
            <div class="alert alert-warning" *ngIf="currentCourses.length === 0 && !isLoading">
                <p>Список пуст</p>
            </div>
          </div>
        </tab>
        <tab heading="Прошедшие">
          <preloader  *ngIf="isLoading"></preloader>
          <div class="content table-responsive table-full-width" *ngIf="oldCourses.length !== 0">
            <table class="table table-striped table-hover">
              <tr>
                <th>Номер</th>
                <th>Название</th>
                <th>Начало</th>
                <th>Конец</th>
                <th>Набор</th>
                <th>Инфо</th>
              </tr>
              <ng-container *ngFor="let course of oldCourses">
                <tr (click)="showListOfListners(course)" [ngClass]="{'active': course.isOpened}">
                    <td>{{course.Number}}</td>
                    <td>{{course.name}}</td>
                    <td>{{course.Start | date: "dd.MM.yy"}}</td>
                    <td>{{course.Finish | date: "dd.MM.yy"}}</td>
                    <td>{{ course.Size }}</td>
                    <td>{{ course.Notes }}</td>
                </tr>
                <tr *ngIf="course.isOpened">
                  <td colspan="6" class="no-padding">
                    <table-list [course]="course" [disableEnter]="true"></table-list>
                  </td>   
                </tr>
              </ng-container>
              <tr *ngIf="message.length != 0">
                <td>{{ message }}</td>
              </tr>
            </table>
          </div>
          <div class="content">
            <div class="alert alert-warning" *ngIf="oldCourses.length === 0 && !isLoading">
                <p>Список пуст</p>
            </div>
          </div>
        </tab>
        <tab heading="Список курсов-{{ nowYear }}">
          <preloader  *ngIf="isLoading"></preloader>
          <div class="content table-responsive table-full-width" *ngIf="courseList.length !== 0 && !isLoading">
            <table class="table table-striped table-hover">
              <tr>
                <th>Номер</th>
                <th>Название</th>
                <th>Начало</th>
                <th>Конец</th>
                <th>Набор</th>
                <th>Инфо</th>
              </tr>
              <ng-container *ngFor="let course of courseList">
                <tr (click)="showListOfListners(course)" [ngClass]="{'active': course.isOpened, 'danger': course.class === 1, 'success': course.class === 2}">
                    <td>{{course.Number}}</td>
                    <td>{{course.name}}</td>
                    <td>{{course.Start | date: "dd.MM.yy"}}</td>
                    <td>{{course.Finish | date: "dd.MM.yy"}}</td>
                    <td>{{ course.Size }}</td>
                    <td>{{ course.Notes }}</td>
                </tr>
                <tr *ngIf="course.isOpened">
                  <td colspan="6" class="no-padding">
                    <table-list [course]="course"></table-list>
                  </td>   
                </tr>
              </ng-container>
              <tr *ngIf="message.length != 0">
                <td>{{ message }}</td>
              </tr>
            </table>
          </div>
          <div class="content">
            <div class="alert alert-warning" *ngIf="courseList.length === 0 && !isLoading">
                <p>Список пуст</p>
            </div>
          </div>
        </tab>
        <!-- <tab heading="Предстоящие">
          <preloader  *ngIf="isLoading"></preloader>
          <div class="content table-responsive table-full-width" *ngIf="futureCourses.length !== 0">
            <table class="table table-striped table-hover">
              <tr>
                <th>Номер</th>
                <th>Название</th>
                <th>Начало</th>
                <th>Конец</th>
                <th>Набор</th>
                <th>Инфо</th>
              </tr>
              <ng-container *ngFor="let course of futureCourses">
                <tr (click)="showListOfListners(course)" [ngClass]="{'active': course.isOpened}">
                    <td>{{course.Number}}</td>
                    <td>{{course.name}}</td>
                    <td>{{course.Start | date: "dd.MM.yy"}}</td>
                    <td>{{course.Finish | date: "dd.MM.yy"}}</td>
                    <td>{{ course.Size }}</td>
                    <td>{{ course.Notes }}</td>
                </tr>
                <tr *ngIf="course.isOpened">
                  <td colspan="6" class="no-padding">
                    <table-list [course]="course"></table-list>
                  </td>   
                </tr>
              </ng-container>
              <tr *ngIf="message.length != 0">
                <td>{{ message }}</td>
              </tr>
            </table>
          </div>
          <div class="content">
            <div class="alert alert-warning" *ngIf="futureCourses.length === 0 && !isLoading">
                <p>Список пуст</p>
            </div>
          </div>
        </tab> -->
        <tab heading="Архивчик" (select)="getArchive()">
          <archive></archive>
        </tab>
      </tabset>
    </ng-container>
</div>